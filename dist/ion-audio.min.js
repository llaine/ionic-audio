function ionAudioTrack(i,n){function o(i,n,o,t){t.hasOwnProgressBar=n.find("ion-audio-progress-bar").length>0}function t(o,t){var r=this,a=function(n,o){n&&n.url&&(n.progress=0,n.status=0,n.duration=-1,o&&void 0!==o.id&&(n.id=o.id),i&&i.add(n,e,null,u,s))},e=function(){o.track.status=0,o.track.progress=0},u=function(i){o.track.status=i},s=function(i,n){o.track.progress=i,o.track.duration=n},c=function(){n.$broadcast("ionic-audio:trackChange",o.track)};this.seekTo=function(n){i.seekTo(n)},this.getTrack=function(){return o.track},this.start=function(){return o.track&&o.track.url?(i.play(o.track.id),r.hasOwnProgressBar||c(),o.track.id):void 0};var d=o.$watch("track",function(n,o){void 0!==n&&(i.stop(),a(n,o))});o.$on("$destroy",function(){d(),i.destroy()})}return{transclude:!0,template:"<ng-transclude></ng-transclude>",restrict:"E",scope:{track:"=",togglePlayback:"="},require:"ionAudioTrack",link:o,controller:["$scope","$element",t]}}function ionAudioProgress(){return{restrict:"E",scope:{track:"="},template:"{{track.progress | time}}"}}function ionAudioProgressBar(i){function n(n,o,t){function r(){n.track.progress=0,n.track.status=0,n.track.duration=-1}var a,e=o.find("input");angular.isDefined(t.displayTime)||(o.find("ion-audio-progress").remove(),o.find("ion-audio-duration").remove()),angular.isDefined(t.displayInfo)||o.find("h2").remove(),angular.isUndefined(n.track)&&(n.track={},a=n.$on("ionic-audio:trackChange",function(i,o){n.track=o}));var u=n.$watch("track.status",function(i){e.prop("disabled",0==i)});n.displayTrackInfo=function(){return{visibility:angular.isDefined(t.displayInfo)&&(n.track.title||n.track.artist)?"visible":"hidden"}},n.sliderRelease=function(){var o=n.track.progress;i.seekTo(o)},n.$on("$destroy",function(){u(),angular.isDefined(a)&&a()}),r()}return{restrict:"E",scope:{track:"="},template:'<h2 class="ion-audio-track-info" ng-style="displayTrackInfo()">{{track.title}} - {{track.artist}}</h2><div class="range"><ion-audio-progress track="track"></ion-audio-progress><input type="range" name="volume" min="0" max="{{track.duration}}" ng-model="track.progress" on-release="sliderRelease()" disabled><ion-audio-duration track="track"></ion-audio-duration></div>',link:n}}function ionAudioPlay(i,n){function o(o,t,r,a){var e,u,s=0,c=function(){e=!1,t.addClass("ion-play"),t.removeClass("ion-pause"),t.text(r.textPlay)},d=function(){r.textPlay&&r.textPause&&t.text(t.text()==r.textPlay?r.textPause:r.textPlay)},l=function(){t.toggleClass("ion-play ion-pause"),d()};i.on("tap",function(){return u||e?void(u=!1):(0==s&&(e=!0),a.play(),void l())},t),i.on("doubletap",function(){u=!0},t);var g=o.$parent.$watch("track.status",function(i){0==i||4==i?c():2==i&&(e=!1),s=i}),f=o.$parent.$watch("togglePlayback",function(i,o){i!=o&&n(function(){l(),a.play()},300)});c(),o.$on("$destroy",function(){g(),f()})}return{restrict:"A",require:"^^ionAudioControls",link:o}}function ionAudioDuration(){return{restrict:"E",scope:{track:"="},template:"{{track.duration | duration}}"}}angular.module("ionic-audio",["ionic"]),angular.module("ionic-audio").filter("time",function(){var i=function(i){return(new Array(2).join("0")+i).slice(-2)};return function(n){n=n||0;var o=parseInt(n);return i(Math.floor(o/60))+":"+i(o%60)}}),angular.module("ionic-audio").filter("duration",["$filter",function(i){return function(n){return n>0?i("time")(n):""}}]),angular.module("ionic-audio").factory("MediaManager",["$interval","$timeout","$window","$rootScope",function(i,n,o,t){function r(i){if(!(i.id<0)){var n=b.filter(function(n){return n.id==i.id}).pop();return n&&b.splice(n.id,1,i),n}}function a(i,n,o,t,a){return i.url?(angular.extend(i,{onSuccess:n,onError:o,onStatusChange:t,onProgress:a,status:0,duration:-1,progress:0}),r(i)?i.id:(i.id=b.push(i)-1,i.id)):void console.log("ionic-audio: missing track url")}function e(i){if(angular.isNumber(i)&&!(i>b.length-1)){if(y){if(y.id==i)return void(y.status==Media.MEDIA_RUNNING?u():l());y.id>-1&&(t.$broadcast("track.stopped",y.status),t.$emit("track.stopped",y.status),g())}n(function(){d(b[i])},300)}}function u(){console.log("ionic-audio: pausing track "+y.title),A.pause(),h()}function s(i){A&&A.seekTo(1e3*i)}function c(){t.$broadcast("track.stopped","toto"),t.$emit("track.stopped","toto"),h(),p()}function d(i){y=i,console.log("ionic-audio: playing track "+y.title),A=f(y),A.play(),$()}function l(){console.log("ionic-audio: resuming track "+y.title),A.play(),$()}function g(){t.$broadcast("track.stopped","toto"),t.$emit("track.stopped","toto"),A&&(console.log("ionic-audio: stopping track "+y.title),A.stop())}function f(i){return i.url?new Media(i.url,angular.bind(i,k),angular.bind(i,v),angular.bind(i,m)):void console.log("ionic-audio: missing track url")}function p(){angular.isDefined(A)&&(A.release(),A=void 0,y=void 0)}function k(){h(),p(),angular.isFunction(this.onSuccess)&&this.onSuccess()}function v(){angular.isFunction(this.onError)&&this.onError()}function m(i){this.status=i,angular.isFunction(this.onStatusChange)&&this.onStatusChange(i)}function h(){angular.isDefined(P)&&(t.$broadcast("track.stopped","toto"),t.$emit("track.stopped","toto"),i.cancel(P),P=void 0)}function $(){angular.isDefined(P)||y&&(P=i(function(){y.duration<0&&(y.duration=A.getDuration()),A.getCurrentPosition(function(i){i>-1&&(y.progress=i)},function(i){console.log("Error getting pos="+i)}),angular.isFunction(y.onProgress)&&y.onProgress(y.progress,y.duration)},1e3))}var y,A,P,b=[];return o.cordova||o.Media?{add:a,play:e,pause:u,stop:g,seekTo:s,destroy:c}:(console.log("ionic-audio: missing Cordova Media plugin. Have you installed the plugin? \nRun 'ionic plugin add cordova-plugin-media'"),null)}]),angular.module("ionic-audio").directive("ionAudioTrack",["MediaManager","$rootScope",ionAudioTrack]),angular.module("ionic-audio").directive("ionAudioProgress",ionAudioProgress),angular.module("ionic-audio").directive("ionAudioProgressBar",["MediaManager",ionAudioProgressBar]),angular.module("ionic-audio").directive("ionAudioPlay",["$ionicGesture","$timeout",ionAudioPlay]),angular.module("ionic-audio").directive("ionAudioDuration",ionAudioDuration),angular.module("ionic-audio").directive("ionAudioControls",function(){function i(i,n){var o,t=n.find("ion-spinner"),r=this;t.addClass("ng-hide"),this.toggleSpinner=function(){t.toggleClass("ng-hide")},this.play=function(){o||r.toggleSpinner(),this.start()};var a=i.$parent.$watch("track.status",function(i){switch(i){case 1:o=!1;break;case 2:o||(r.toggleSpinner(),o=!0);break;case 0:case 4:o=!1}});i.$on("$destroy",function(){a()})}function n(i,n,o,t){t[0].start=t[1].start}return{restrict:"EA",require:["ionAudioControls","^^ionAudioTrack"],controller:["$scope","$element",i],link:n}});